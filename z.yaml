default: readme
tasks:
  install: go install
  release:
    desc: z release v1.0.0
    run:
      - git tag
      - git push origin
    tasks:
      install:
        desc: Install via gobinaries
        run:
          - curl -sSL gobinaries.com/zakuro9715/z | sh
  readme:
    desc: Generate readme
    run:
      - sh scripts/generate-readme.sh
  test:
    - go install
    - go test ./...
  run:
    - go install
    - go run .
  bench:
    - go install
    - go test -bench . -benchmem
  bench.write: |
    txt=$(cat benchmark.txt)

    bar="=========================="
    header="$bar $(date '+%Y-%m-%d'): $(git rev-parse HEAD) $bar"
    echo $header > benchmark.txt
    z bench >> benchmark.txt
    echo $header | sed 's/./=/g' >> benchmark.txt
    echo "$txt" >> benchmark.txt
